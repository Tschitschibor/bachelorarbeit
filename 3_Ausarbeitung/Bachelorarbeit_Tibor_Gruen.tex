\documentclass{article}
\usepackage[top=37mm,bottom=37mm,left=27mm,right=27mm]{geometry}

\usepackage[utf8]{inputenc}
\usepackage{fancyvrb}

%%% For captions and references
\usepackage{hyperref}
\usepackage{hypcap}
\newcommand{\Algoref}[1]{%
	\hyperref[algo:#1]{Algorithm~\ref*{algo:#1}}%
}
\newcommand{\algoref}[1]{%
	\hyperref[algo:#1]{Algorithm~\ref*{algo:#1}}%
}
\newcommand{\Funcref}[1]{%
	\hyperref[func:#1]{Function~\ref*{func:#1}}%
}
\newcommand{\funcref}[1]{%
	\hyperref[func:#1]{\texttt{#1}}%
}

%%% For footnotes at end of text
\usepackage{endnotes}
%\let\footnote{\endnote}
%% Heading of endnotes section
\renewcommand*{\notesname}{Annotations}

\makeatletter
\renewcommand*{\enoteheading}{%
   \section*{\notesname%
   \@mkboth{\MakeUppercase{\notesname}}{\MakeUppercase{\notesname}}}%
\mbox{}\par\vskip-\baselineskip}
\makeatother

%%% For quotation
\usepackage{csquotes}

%%% For proper underline
\usepackage{soul}
%\setuldepth{gjpqy}
%\setuldepth\strut
\setuldepth{-1}

%%% Color
\usepackage{xcolor}
\usepackage{color}
\definecolor{FireBrick}{rgb}{0.5812,0.0074,0.0083}
\definecolor{RoyalBlue}{rgb}{0.0236,0.0894,0.6179}
\definecolor{RoyalGreen}{rgb}{0.0236,0.6179,0.0894}
\definecolor{RoyalRed}{rgb}{0.6179,0.0236,0.0894}
\definecolor{LightBlue}{rgb}{0.8544,0.9511,1.0000}
\definecolor{Black}{rgb}{0.0,0.0,0.0}

\definecolor{linkColor}{rgb}{0.0,0.0,0.554}
\definecolor{citeColor}{rgb}{0.0,0.0,0.554}
\definecolor{fileColor}{rgb}{0.0,0.0,0.554}
\definecolor{urlColor}{rgb}{0.0,0.0,0.554}
\definecolor{promptColor}{rgb}{0.0,0.0,0.589}
\definecolor{brkpromptColor}{rgb}{0.589,0.0,0.0}
\definecolor{gapinputColor}{rgb}{0.589,0.0,0.0}
\definecolor{gapoutputColor}{rgb}{0.0,0.0,0.0}

%%  for a long time these were red and blue by default,
%%  now black, but keep variables to overwrite
\definecolor{FuncColor}{rgb}{0.0,0.0,0.0}
%% strange name because of pdflatex bug:
\definecolor{Chapter }{rgb}{0.0,0.0,0.0}
\definecolor{DarkOlive}{rgb}{0.1047,0.2412,0.0064}

%% command for ColorPrompt style examples
\newcommand{\gapprompt}[1]{\color{promptColor}{\bfseries #1}}
\newcommand{\gapbrkprompt}[1]{\color{brkpromptColor}{\bfseries #1}}
\newcommand{\gapinput}[1]{\color{gapinputColor}{#1}}

%%% For source code listings
\usepackage{listings}[2013/08/05]
\input{pfad.tex}
%\lstloadlanguages{GAP}

%%% For algorithm styles
\usepackage[linesnumbered,ruled]{algorithm2e}

%%% Math theorem styles
\usepackage{amsthm}

\newtheorem{thm}{Theorem}[subsection]
\newtheorem{lemma}[thm]{Lemma}
\theoremstyle{definition}
\newtheorem{definition}[thm]{Definition}
\newtheorem{remark}[thm]{Remark}
\newtheorem{example}[thm]{Example}


%%% For Math
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amsbsy}
\usepackage{amsthm}
\usepackage{amssymb}

\usepackage{mathtools}
\usepackage{commath}
\usepackage[sc,osf]{mathpazo}

%%% For arrows and categories
\usepackage[all]{xy}
\usepackage{tikz-cd}

%%% tikz
\usetikzlibrary{positioning}

%%% For dotted box around diagrams
\tikzcdset{
    boxedcd/.style={
        every matrix/.append style={
            draw=black,
            dotted,
            rounded corners,
            #1
        },
    },
}

%%% For dotted arrows in math and in text
%% dottedrightarrow
\makeatletter
\newbox\dottedrightarrow@box
\setbox\dottedrightarrow@box\hbox
  {%
    \begin{tikzpicture}
      \draw[dotted,->] (0,0) -- (1.5em,0);
    \end{tikzpicture}%
  }
\newcommand*\dottedrightarrow
  {\relax\ifmmode\expandafter\dottedrightarrow@m\else\expandafter\dottedrightarrow@t\fi}
\newcommand*\dottedrightarrow@t[1][1.5em]
  {\resizebox{#1}{!}{\raisebox{.5ex}{\usebox\dottedrightarrow@box}}}
\newcommand*\dottedrightarrow@m[1][]
  {%
    \if\relax\detokenize{#1}\relax
      \mathchoice% values are trial and error based\ldots
        {\dottedrightarrow@t}
        {\dottedrightarrow@t}
        {\dottedrightarrow@t[1.1em]}
        {\dottedrightarrow@t[0.9em]}%
    \else
      \dottedrightarrow@t[#1]%
    \fi
  }
\makeatother
\let\olddottedrightarrow\dottedrightarrow
\renewcommand{\dottedrightarrow}{\raisebox{-.2em}{\olddottedrightarrow}}
%% dottedleftarrow
\makeatletter
\newbox\dottedleftarrow@box
\setbox\dottedleftarrow@box\hbox
  {%
    \begin{tikzpicture}
      \draw[dotted,<-] (0,0) -- (1.5em,0);
    \end{tikzpicture}%
  }
\newcommand*\dottedleftarrow
  {\relax\ifmmode\expandafter\dottedleftarrow@m\else\expandafter\dottedleftarrow@t\fi}
\newcommand*\dottedleftarrow@t[1][1.5em]
  {\resizebox{#1}{!}{\raisebox{.5ex}{\usebox\dottedleftarrow@box}}}
\newcommand*\dottedleftarrow@m[1][]
  {%
    \if\relax\detokenize{#1}\relax
      \mathchoice% values are trial and error based\ldots
        {\dottedleftarrow@t}
        {\dottedleftarrow@t}
        {\dottedleftarrow@t[1.1em]}
        {\dottedleftarrow@t[0.9em]}%
    \else
      \dottedleftarrow@t[#1]%
    \fi
  }
\makeatother
\let\olddottedleftarrow\dottedleftarrow
\renewcommand{\dottedleftarrow}{\raisebox{-.2em}{\olddottedleftarrow}}


%%% For some big dots
\makeatletter
\newcommand*{\bigcdot}{}% Check if undefined
\DeclareRobustCommand*{\bigcdot}{%
  \mathbin{\mathpalette\bigcdot@{}}%
}
\newcommand*{\bigcdot@scalefactor}{.5}
\newcommand*{\bigcdot@widthfactor}{1.15}
\newcommand*{\bigcdot@}[2]{%
  % #1: math style
  % #2: unused
  \sbox0{$#1\vcenter{}$}% math axis
  \sbox2{$#1\cdot\m@th$}%
  \hbox to \bigcdot@widthfactor\wd2{%
    \hfil
    \raise\ht0\hbox{%
      \scalebox{\bigcdot@scalefactor}{%
        \lower\ht0\hbox{$#1\bullet\m@th$}%
      }%
    }%
    \hfil
  }%
}
\makeatother



\begin{document}
\tableofcontents\label{toc}
\section{Preface}

\section{Introduction to quivers and category theory}
\input{tex/en/Quivers_and_Categories.tex}

\section{Datatype convention of catreps}
\input{tex/en/Datatype_convention_of_catreps.tex}

\section{The category FinSets}

There are algorithms whose sole purpose is to convert data structures, so they are not of much interest to the mathematical theory,
and then there are algorithms that implement our category theoretical calculations, so they are important to our theory.

The algorithms \hyperref[func:ConvertToMapOfFinSets]{\texttt{ConvertToMapOfFinSets}},\\
\hyperref[func:ConcreteCategoryForCAP]{\texttt{ConcreteCategoryForCAP}} and
\hyperref[func:RightQuiverFromConcreteCategory]{\texttt{RightQuiverFromConcreteCategory}}\\
are more of the data structure conversion type, while 
\hyperref[func:RelationsOfEndomorphisms]{\texttt{RelationsOfEndomorphisms}},\\
\hyperref[func:Algebroid]{\texttt{Algebroid}},\\
\hyperref[func:EmbeddingOfSubRepresentation]{\texttt{EmbeddingOfSubRepresentation}}\\
and \hyperref[func:WeakDirectSumDecomposition]{\texttt{WeakDirectSumDecomposition}} are also important to our theory.

\subsection{MapOfFinSets}

\begin{algorithm}\capstart
   \caption{\texttt{ConvertToMapOfFinSets}}\label{algo:ConvertToMapOfFinSets}
      \SetKwInput{Input}{Input~}
      \SetKwInput{Output}{Output~}
      \Input{~a list $objects$ of objects in FinSets and a morphism $gen$ given as a list of images in the convention of catreps}
      \Output{~the corresponding map of finite sets from source $S$ to target $T$}
      \BlankLine
      let $T$ be the first object $O \in objects$ such that $gen \cap O \not= \emptyset$\;
      \If{$gen \cap O = \emptyset \, \forall O \in objects$}{
         Error "unable to find target set"
      }
      let $fl$ be the flattening of $objects$ as a list\;
      let $S$ be the sublist of $fl$ according to positions $i$ such that $gen[i]$ is bound\;
      set $S$ to be the first object $O \in objects$ such that $O = S$\;
      \If{$S \not= O \, \forall O \in objects$}{
          Error "unable to find source set"
      }
      \BlankLine
      let $G$ be the list of pairs $[ i, gen[i] ], i \in S$;
      \BlankLine
      \Return MapOfFinSets( S, G, T );
\end{algorithm}

\section{The categories Functor-Categories and Cat-Reps}
\section{Conclusion}

%% best endnotes are in Westend-Verlag style: 
%% All at the end, sorted by chapter, starting from 1 at each new chapter.

%%% insert endnotes in some way
\begingroup
     \parindent 0pt
     \parskip 2ex
     \def\enotesize{\normalsize}
     \theendnotes
\endgroup 

\addcontentsline{toc}{section}{References}
\input{bib/sources.bib}

\appendix
\renewcommand{\thesection}{\Alph{section}}
\section{Implementation in \textsc{Cap}}
\input{tex/en/Implementation_in_CAP.tex}

\end{document}