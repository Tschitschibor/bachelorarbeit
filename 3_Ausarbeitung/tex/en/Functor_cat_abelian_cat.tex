\label{sect:abelian_cat}
Goal is to show that

The functor category with values in $\kmat$ is an Abelian category with enough projectives (constructively) and direct sum decomposition (constructively).

\subsection{Abelian category}

\begin{definition}[The functor category $\HomAkmat$]
Let $\Bbbk$ be a commutative ring, and let $\mathcal{A}$ be a finite-dimensional algebroid over $\Bbbk$.\\
The \ul{functor category} $\HomAkmat$ has as objects $\Bbbk$-linear functors $F : \mathcal{A} \rightarrow \kmat \in \HomAkmat_{0}$, where each
object $i \in \mathcal{A}$ gets mapped to a natural number $F(i) \in \kmat_{0} = \mathbb{N}_{0}$, and each
morphism $b : i \rightarrow j \in \mathcal{A}_{1}$ gets mapped to an $F(i) \times F(j)$ matrix $F(b) : F(i) \rightarrow F(j) \in \kmat_{1}$.
A morphism $\alpha : F \rightarrow G \in \HomAkmat_{1}$ is a natural transformation $\alpha : F \Rightarrow G$ with each component
$\alpha_{i} : F(i) \rightarrow G(i) \in \kmat_{1}$ for an object $i \in \mathcal{A}$ being a $F(i) \times G(i)$ matrix satisfying the
naturality conditions in \eqref{eq:naturality_condition}.
\end{definition}

\begin{example}[Limits and colimits in $\kmat$]
In our target category $\kmat$ which is an abelian category, we have the following limits, colimits and special bilimts:
\begin{itemize}
\item A zero object $0 \in \kmat_{0}$
\item For every finite set $I$ and family $\{S_{i}\}_{i \in I}$ we have the direct sum
\[
(S = \bigoplus_{i\in I} S_{i}, \{\pi_{i} : S \rightarrow S_{i}\}, \{\iota_{i} : S_{i} \rightarrow S\}, u_{\text{in}}(\tau), u_{\text{out}}(\tau))
\]
\item An equalizer of the diagram 
\[
\begin{tikzcd}
A \arrow[rr, "{0_{A,B}}"', shift right] \arrow[rd] \arrow[rr, "\alpha", shift left] &              & B \\
                                                                               & 0 \arrow[ru] &  
\end{tikzcd}
\]
called kernel, i.e. for the matrix $\alpha : A \rightarrow B$ we have
\[
(K = \mathrm{ker}(\alpha), \mathrm{KernelEmbedding}(\alpha), \mathrm{KernelLift}(\alpha,\tau))
\]
\[
\begin{tikzcd}
K \arrow[rrr, "{\mathrm{KernelEmbedding}(\alpha)}", hook]                              &  &  & A \arrow[r, "\alpha"] & B \\
T \arrow[rrru, "\tau"', bend right] \arrow[u, "{\mathrm{KernelLift}(\alpha,\tau)}", dashed] &  &  &                       &  
\end{tikzcd}
\]
\item A co-equalizer of the same diagram called cokernel, i.e. for the matrix $A \in \Bbbk^{m\times n}$ we have
\[
(C = \mathrm{coker}(\alpha), \mathrm{CokernelProjection}(\alpha), \mathrm{CokernelColift}(\alpha,\tau))
\]
\[
\begin{tikzcd}
C \arrow[d, "{\mathrm{CokernelColift}(\alpha,\tau)}"', dashed] &  &  & B \arrow[lll, "\mathrm{CokernelProjection}(\alpha)"', two heads] \arrow[llld, "\tau", bend left] & A \arrow[l, "\alpha"'] \\
T                                                              &  &  &                                                                                       &                       
\end{tikzcd}
\]
\item For objects $A, K, T \in \kmat_{0}$ and morphisms $\iota : K \rightarrow A, \tau : T \rightarrow A$ we have a lift of $\tau$ along $\iota$
given by a morphism $u : T \rightarrow K$ such that $u \iota = \tau$.
\[
\begin{tikzcd}
                                              & K \arrow[rd, "\iota"] &   \\
T \arrow[rr, "\tau"'] \arrow[ru, "u", dashed] &                       & A
\end{tikzcd}
\]
\item For objects $A,C,T \in \kmat_{0}$ and morphisms $\varepsilon : A \rightarrow C, \tau : A \rightarrow T$ we have a colift of $\tau$ along
$\varepsilon$ given by a morphism $u : C \rightarrow T$ such that $\varepsilon u = \tau$.
\[
\begin{tikzcd}
A \arrow[rr, "\tau"] \arrow[rd, "\varepsilon"'] &                            & T \\
                                                & C \arrow[ru, "u"', dashed] &  
\end{tikzcd}
\]
\item A dependent function $( - / - )$ mapping a pair $\iota : K \rightarrow A, \tau : T \rightarrow A$ to a lift $(\tau / \iota )$ of
$\tau$ along $\iota$, where $A, K, T \in \kmat_{0}$, $\iota$ is a monomorphism and $\tau\,\mathrm{CokernelProjection}(\iota) = 0$.
\item A dependent function $( - \backslash - )$ mapping a pair $\varepsilon : A \rightarrow C, \tau : A \rightarrow T$ to a colift
$(\varepsilon \backslash \tau )$ of
$\tau$ along $\varepsilon$, where $A, C, T \in \kmat_{0}$, $\varepsilon$ is an epimorphism and $\mathrm{KernelEmbedding}(\varepsilon)\tau = 0$.
\end{itemize}
\end{example}

Our category $\HomAkmat$ has all of these limits.


\begin{theorem}\label{thm:functor_category_abelian}
Let $\mathcal{A}$ be a finite-dimensional algebroid over some field $\Bbbk$. The functor category $\HomAkmat$
is an abelian category.
\end{theorem}
\begin{proof}
We prove that $\HomAkmat$ is an Ab-category, then that it is also an additive category and a pre-abelian category and finally that
it is an abelian category.
\begin{enumerate}
\renewcommand{\labelenumi}{(\theenumi)}
\item In order to show that $\HomAkmat$ is an Ab-category, we must show that 
\begin{enumerate}
\renewcommand{\labelenumii}{(\roman{enumii})}
\item for any two objects $F,G \in \HomAkmat_{0}$ the hom-set $\mathrm{Hom}_{\HomAkmat}(F,G)$ between them is an Abelian group, and
\item that the composition of two morphisms\\
$\mu : \mathrm{Hom}_{\HomAkmat}(F,G) \times \mathrm{Hom}_{\HomAkmat}(G,H) \rightarrow \mathrm{Hom}_{\HomAkmat}(F,H)$ is a
bilinear map, i.e. for $\eta, \varepsilon \in \mathrm{Hom}_{\HomAkmat}(F,G)$ and $\varphi, \psi \in \mathrm{Hom}_{\HomAkmat}(G,H)$ and
for $x \in \Bbbk$
\begin{align}
(\eta + \varepsilon)\varphi &= \eta\varphi + \varepsilon\varphi \\
\eta(\varphi + \psi) &= \eta\varphi + \eta\psi \\
(x\eta)\varphi &= \eta(x\varphi) = x(\eta\varphi).
\end{align}
\end{enumerate}

\begin{subproof}[Proof of (i)]
For any object $c \in \mathcal{A}$, the set of components $\mathrm{Hom}_{\kmat}(Fc,Gc)$ is a $\Bbbk$-vector space and therefore an
Abelian group.

We define the addition and scalar multiplication
\begin{align*}
+ :&& \mathrm{Hom}_{\HomAkmat}(F,G) &\times \mathrm{Hom}_{\HomAkmat}(F,G) \rightarrow \mathrm{Hom}_{\HomAkmat}(F,G)\\
\cdot :&& \Bbbk &\times \mathrm{Hom}_{\HomAkmat}(F,G) \rightarrow \mathrm{Hom}_{\HomAkmat}(F,G)
\end{align*}
component-wise: $\forall \eta, \varepsilon \in \mathrm{Hom}_{\HomAkmat}(F,G), \forall x \in \Bbbk, \forall c \in \mathcal{A}$
\begin{align}
(\eta+\varepsilon)_{c} &:= \eta_{c} + \varepsilon_{c}\\
(x \eta)_{c} &:= x\eta_{c}
\end{align}
where the right-hand side is the usual addition and scalar multiplication of matrices.

We identify as the neutral element $0_{F,G} \in \mathrm{Hom}_{\HomAkmat}(F,G)$ (or simply $0$ when the context is clear)
the natural transformation $0$ with each component $0_{c} = 0_{Fc,Gc}$ being the $Fc\times Gc$ zero matrix.
For each natural transformation $\eta$ the additive inverse $-\eta$ is defined component-wise as
\begin{align}
(-\eta)_{c} &:= -\eta_{c}.
\end{align}
We also confirm that the addition is commutative:
\begin{align}
(\eta+\varepsilon)_{c} &= \eta_{c} + \varepsilon_{c}\\
    &= \varepsilon_{c} + \eta_{c}\\
    &= (\varepsilon + \eta)_{c}
\end{align}
This concludes that for each $F, G \in \HomAkmat,\, \mathrm{Hom}_{\HomAkmat}(F,G)$ is an Abelian group.
\end{subproof}
\begin{subproof}[Proof of (ii)]
Let $F, G, H \in \HomAkmat$ and let $\eta, \varepsilon \in \mathrm{Hom}_{\HomAkmat}(F,G)$,
$\varphi, \psi \in \mathrm{Hom}_{\HomAkmat}(G,H)$ and $x \in \Bbbk$.\\
The composition $\eta\varphi \in \mathrm{Hom}_{\HomAkmat}(F,H)$ is defined by component-wise matrix-multiplication,
i.e. $\forall c \in \mathcal{A}$
\begin{align*}
(\eta\varphi)_{c} := \eta_{c}\varphi_{c}
\end{align*}
and from this follows the bilinearity of the composition, since the matrix multiplication is bilinear.\\
This concludes the first part of the proof, i.e. $\HomAkmat$ is an Ab-category.
\end{subproof}

\item Next we show that $\HomAkmat$ is an additive category, i.e. it is
\begin{enumerate}
\renewcommand{\labelenumii}{(\roman{enumii})}
\item An Ab-category with
\item A dependent function $\oplus$ mapping a finite set $I$ and a collection $(F_{i})_{i\in I}$ of objects in $\HomAkmat$
to a corresponding direct sum $( \oplus_{i\in I} F_{i}, (\pi_{i})_{i\in I}, (\iota_{i})_{i\in I}, u_{\mathrm{in}}, u_{\mathrm{out}} )$.
\end{enumerate}
\begin{subproof}[Proof of (ii)]
We will make extensive use of the direct sum in $\kmat$ as described in \ref{ex:kmat_additive} and \ref{ex:block_diagonal_matrix} to
define the direct sum in $\HomAkmat$.
Let $I = \{1,\dots,n\}$ be a finite set, and $F_{i} \in \HomAkmat_{0}, 1\leq i\leq n$.
\begin{itemize}
\item The object $F := \oplus_{i=1}^{n} F_{i}$ is a functor, mapping
each object $c \in \mathcal{A}_{0}$ to the object $Fc = \oplus_{i=1}^{n} F_{i}c = \sum_{i=1}^{n} F_{i}c \in \kmat_{0}$ by the direct sum in
$\kmat$.\\
Each $F_{i}$ also defines a family of matrices $\{F_{i} a : F_{i} c \rightarrow F_{i} c' \}_{a : c \rightarrow c' \in \mathcal{A}_{1}}$.
$F_{i} a : F_{i} c \rightarrow F_{i} c'$
\item For a morphism $a : c \rightarrow c' \in \mathcal{A}_{1}$ we have a family of morphisms 
$\{F_{i} a : F_{i} c \rightarrow F_{i} c'\}_{1 \leq i \leq n}$.
$F a : Fc \rightarrow Fc'$ that is the block-diagonal matrix of the $F_{i}a$'s.
In other words, we can identify each $F_{j}a$ as a $F_{j} c \times F_{j} c'$ submatrix:
\[
\left(F_{j}a\right)_{k,l} = \left(F a\right)_{\sum_{i=1}^{j-1} F_{i}c + k,\,\sum_{i=1}^{j-1} F_{i}c' + l},
1 \leq k \leq F_{j}c, 1 \leq l \leq F_{j}c'
\]

define $\pi_{i}, \iota_{i}$, for $\tau, \rho, u_{\mathrm{in}}(\tau), u_{\mathrm{out}}(\rho)$,

Let $i \in I$. The morphism $\pi_{i} : F \rightarrow F_{i};$ is a natural transformation that is defined by its components
$\forall c \in \mathcal{A}_{0}, (\pi_{i})_{c} : F(c) \rightarrow F_{i}(c)$ is a matrix defined as in \ref{ex:kmat_additive}:
\begin{align}
(\pi_{i})_{c} := \begin{pmatrix}
0_{\sum_{j=1}^{i-1} F_{j}(c), F_{i}(c)} \\
1_{F_{i}(c)} \\
0_{\sum_{j=i+1}^{N} F_{j}(c), F_{i}(c)}
\end{pmatrix}
\end{align}

\end{itemize}

prove:
properties are fulfilled.

The sets of projections $\pi = \{ \pi_{i} : F \rightarrow F_{i} \}_{i = 1,\dots,n}$ and coprojections
$\iota = \{ \iota_{i} : F_{i} \rightarrow F \}_{i = 1,\dots,n}$ are sets of natural transformations,
where each $\pi_{i}$ and $\iota_{i}$ is defined by its components:\\
For $c \in \mathcal{A}_{0}$ we have $(\pi_{i})_{c} : Fc \rightarrow F_{i}c$ and $(\iota_{i})_{c} : F_{i}c \rightarrow Fc$ with\\
\begin{minipage}{.35\textwidth}
\[
\sum_{i=1}^{n} (\pi_{i})_{c} (\iota_{i})_{c} = 1_{Fc}
\]
\end{minipage}
\begin{minipage}{.1\textwidth}
and
\end{minipage}
\begin{minipage}{.55\textwidth}
\[
(\iota_{i})_{c}(\pi_{j})_{c} = (\delta_{i,j})_{c} = \begin{cases}
1_{F_{i}c} & \text{ if } i = j \\
0_{F_{i}c, F_{j}c} & \text{ if } i \neq j
\end{cases}
\]
\end{minipage}

For a family of natural transformations $\tau = \{ \tau_{i} : G \rightarrow F_{i} \}_{i = 1,\dots,n}$

\begin{align*}
\forall c \in \mathcal{A}_{0},&& &&  (\oplus_{i \in I} F_{i}) c &= \oplus_{i \in I} (F_{i} c) \\
\forall c \in \mathcal{A}_{0},&& \forall i \in I,&& (\pi_{i} : F \rightarrow F_{i})_{c} &= (\pi_{i})_{c} : Fc \rightarrow F_{i} c \\
\forall c \in \mathcal{A}_{0},&& \forall i \in I,&& (\iota_{i} : F_{i} \rightarrow F)_{c} &= (\iota_{i})_{c} : F_{i} c \rightarrow Fc \\
\forall c \in \mathcal{A}_{0},&& \forall \tau = \{ \tau_{i} : G \rightarrow F_{i} \}_{i = 1,\dots,n},&&
(u_{\mathrm{in}}(\tau))_{c} &= u_{\mathrm{in}}(\tau_{c}) \\
\forall c \in \mathcal{A}_{0},&& \forall \rho = \{ \rho_{i} : F_{i} \rightarrow H \}_{i = 1,\dots,n},&&
(u_{\mathrm{out}}(\rho))_{c} &= u_{\mathrm{out}}(\rho_{c})
\end{align*}

where $\tau_{c} = \{ (\tau_{i})_{c} : Gc \rightarrow F_{i} c \}_{i \in I}$ and $\rho_{c} = \{ (\rho_{i})_{c} : F_{i} c \rightarrow Hc \}_{i \in I}$.

\begin{align*}
u_{\mathrm{in}}(\tau_{c}) p_{i} &= (\tau_{i})_{c} \\
j_{i} u_{\mathrm{out}}(\rho_{c}) &= (\rho_{i})_{c}
\end{align*}

with $\{ p_{i} : Fc \rightarrow F_{i}c \}_{i\in I}$ and $\{ j_{i} : F_{i}c \rightarrow Fc \}_{i \in I}$ the projection and coprojection morphisms
of the direct sum $Fc := \oplus_{i\in I} (F_{i} c)$ of natural numbers $\{F_{i} c \}_{i\in I}$.

Prove that $p_{i} = (\pi_{i})_{c}$ and $j_{i} = (\iota_{i})_{c}$.

The direct sum of a family of functors $\{ F_{i}\}_{i \in I}$ is a functor $F := \oplus_{i \in I} F_{i}$, mapping each object $c \in \mathcal{A}_{0}$
to an object $Fc \in \kmat_{0}$, where $Fc$ is the direct sum of the family $\{ F_{i}c \}_{i \in I}$.
The family of projections $\{ \pi_{i} : F \rightarrow F_{i} \}$ of the direct sum $F$ of functors is a family of natural transformations.
The components of the $\pi_{i}$ under the same object $c \in \mathcal{A}_{0}$ form a family of projections $\{ (\pi_{i})c : Fc \rightarrow F_{i} c\}$
that are the projections in factors of the direct sum $Fc$. Likewise for the family of injections.

We conclude that the 
\end{subproof}

\begin{subproof}[Proof of (ii)]
Let $I = \{1,\dots,n\}$ be a finite set. For each $c \in \mathcal{A}_{0}$ the family $(F_{i})_{i\in I}$ of functors in $\HomAkmat_{0}$ maps $c$ to a
family $(S_{i})_{i\in I} := (F_{i}c)_{i\in I}$ of objects in $\kmat_{0}$. Let $S := \oplus_{i\in I} S_{i}$ be the direct sum of the $S_{i}$'s with projections
$p = \{ p_{i} : S \rightarrow S_{i}\}_{i\in I}$ and coprojections $q = \{ q_{i} : S_{i} \rightarrow S\}_{i\in I}$ as well as dependent functions
$v_{\text{in}}$ and $v_{\text{out}}$ such that each family of morphisms $t = \{ t_{i} : T \rightarrow S_{i}\}_{i\in I}$ gets mapped to a
morphism $v_{\text{in}}(t)$ and each family of morphisms $r = \{ r_{i} : S_{i} \rightarrow R\}_{i\in I}$ gets mapped to a
morphism $v_{\text{out}}(r)$ such that
\begin{align*}
v_{\text{in}}(t) p_{i} &= t_{i} \forall i\in I, \\
q_{i} v_{\text{out}}(r) &= r_{i} \forall i\in I.
\end{align*}
The $p$ and $q$ also satisfy
\begin{align*}
\sum_{i\in I} p_{i} q_{i} &= 1_{S} \text{  and  } \\
q_{i} p_{j} &= \begin{cases}
            1_{S_{i}} & \text{ if } i = j \\
            0_{ij} & \text{ if } i \neq j
        \end{cases}
\end{align*}
We now want to define a direct sum in the functor category, i.e. for the family $(F_{i})_{i\in I}$ the tuple
$(F = \oplus_{i\in I} F_{i}, \pi = (\pi_{i})_{i\in I}, \iota = (\iota_{i})_{i\in I}, u_{\text{in}}, u_{\text{out}})$ with the desired properties of a direct sum.
Let $F$ be the functor mapping each $c\in \mathcal{A}_{0}$ to the object $Fc := S = \oplus_{i\in I} F_{i}c$. This already fixes the source and target of
$Fa$ for a morphism $a : c \rightarrow c' \in \mathcal{A}_{1}$, namely
\begin{align*}
Fa &: Fc \rightarrow Fc' \\
Fa &: \oplus_{i\in I} F_{i}c \rightarrow \oplus_{i\in I} F_{i}c'
\end{align*}
$\pi$ such that $(\pi_{i})_{c} : Fc \rightarrow F_{i}c = p_{i} : S \rightarrow S_{i}$.
\end{subproof}

\item Next we show that $\HomAkmat$ is a pre-abelian category, i.e. an
\begin{enumerate}
\renewcommand{\labelenumii}{(\roman{enumii})}
\item additive category with
\item a dependent function mapping a morphism $\eta : F \rightarrow G \in \HomAkmat_{1}$ to a kernel of $\eta$ and
\item a dependent function mapping a morphism $\eta : F \rightarrow G \in \HomAkmat_{1}$ to a cokernel of $\eta$.
\end{enumerate}
The proof of the existence of kernels and cokernels goes the same way as for the direct sum. In general we proved that the functor category
has all finite limits and colimits of the target category.


\end{enumerate}
\end{proof}
